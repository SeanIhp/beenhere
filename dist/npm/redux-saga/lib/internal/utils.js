"use strict";var exports=module.exports={};var global=window=require('../../../labrador/global.js');
var _promise = require('../../../babel-runtime/core-js/promise.js');

var _promise2 = _interopRequireDefault(_promise);

var _defineProperty2 = require('../../../babel-runtime/core-js/object/define-property.js');

var _defineProperty3 = _interopRequireDefault(_defineProperty2);

var _iterator = require('../../../babel-runtime/core-js/symbol/iterator.js');

var _iterator2 = _interopRequireDefault(_iterator);

var _typeof3 = require('../../../babel-runtime/helpers/typeof.js');

var _typeof4 = _interopRequireDefault(_typeof3);

var _symbol = require('../../../babel-runtime/core-js/symbol.js');

var _symbol2 = _interopRequireDefault(_symbol);

var _assign = require('../../../babel-runtime/core-js/object/assign.js');

var _assign2 = _interopRequireDefault(_assign);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _extends = _assign2.default || function (target) {
  for (var i = 1; i < arguments.length; i++) {
    var source = arguments[i];for (var key in source) {
      if (Object.prototype.hasOwnProperty.call(source, key)) {
        target[key] = source[key];
      }
    }
  }return target;
};

var _typeof = typeof _symbol2.default === "function" && (0, _typeof4.default)(_iterator2.default) === "symbol" ? function (obj) {
  return typeof obj === "undefined" ? "undefined" : (0, _typeof4.default)(obj);
} : function (obj) {
  return obj && typeof _symbol2.default === "function" && obj.constructor === _symbol2.default && obj !== _symbol2.default.prototype ? "symbol" : typeof obj === "undefined" ? "undefined" : (0, _typeof4.default)(obj);
};

exports.check = check;
exports.remove = remove;
exports.deferred = deferred;
exports.arrayOfDeffered = arrayOfDeffered;
exports.delay = delay;
exports.createMockTask = createMockTask;
exports.autoInc = autoInc;
exports.makeIterator = makeIterator;
exports.log = log;
exports.wrapSagaDispatch = wrapSagaDispatch;

function _defineProperty(obj, key, value) {
  if (key in obj) {
    (0, _defineProperty3.default)(obj, key, { value: value, enumerable: true, configurable: true, writable: true });
  } else {
    obj[key] = value;
  }return obj;
}

var sym = exports.sym = function sym(id) {
  return '@@redux-saga/' + id;
};
var TASK = exports.TASK = sym('TASK');
var HELPER = exports.HELPER = sym('HELPER');
var MATCH = exports.MATCH = sym('MATCH');
var CANCEL = exports.CANCEL = sym('cancelPromise');
var SAGA_ACTION = exports.SAGA_ACTION = sym('SAGA_ACTION');
var konst = exports.konst = function konst(v) {
  return function () {
    return v;
  };
};
var kTrue = exports.kTrue = konst(true);
var kFalse = exports.kFalse = konst(false);
var noop = exports.noop = function noop() {};
var ident = exports.ident = function ident(v) {
  return v;
};

function check(value, predicate, error) {
  if (!predicate(value)) {
    log('error', 'uncaught at check', error);
    throw new Error(error);
  }
}

var is = exports.is = {
  undef: function undef(v) {
    return v === null || v === undefined;
  },
  notUndef: function notUndef(v) {
    return v !== null && v !== undefined;
  },
  func: function func(f) {
    return typeof f === 'function';
  },
  number: function number(n) {
    return typeof n === 'number';
  },
  array: Array.isArray,
  promise: function promise(p) {
    return p && is.func(p.then);
  },
  iterator: function iterator(it) {
    return it && is.func(it.next) && is.func(it.throw);
  },
  task: function task(t) {
    return t && t[TASK];
  },
  observable: function observable(ob) {
    return ob && is.func(ob.subscribe);
  },
  buffer: function buffer(buf) {
    return buf && is.func(buf.isEmpty) && is.func(buf.take) && is.func(buf.put);
  },
  pattern: function pattern(pat) {
    return pat && (typeof pat === 'string' || (typeof pat === 'undefined' ? 'undefined' : _typeof(pat)) === 'symbol' || is.func(pat) || is.array(pat));
  },
  channel: function channel(ch) {
    return ch && is.func(ch.take) && is.func(ch.close);
  },
  helper: function helper(it) {
    return it && it[HELPER];
  }
};

function remove(array, item) {
  var index = array.indexOf(item);
  if (index >= 0) {
    array.splice(index, 1);
  }
}

function deferred() {
  var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

  var def = _extends({}, props);
  var promise = new _promise2.default(function (resolve, reject) {
    def.resolve = resolve;
    def.reject = reject;
  });
  def.promise = promise;
  return def;
}

function arrayOfDeffered(length) {
  var arr = [];
  for (var i = 0; i < length; i++) {
    arr.push(deferred());
  }
  return arr;
}

function delay(ms) {
  var val = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;

  var timeoutId = void 0;
  var promise = new _promise2.default(function (resolve) {
    timeoutId = setTimeout(function () {
      return resolve(val);
    }, ms);
  });

  promise[CANCEL] = function () {
    return clearTimeout(timeoutId);
  };

  return promise;
}

function createMockTask() {
  var _ref;

  var running = true;
  var _result = void 0,
      _error = void 0;

  return _ref = {}, _defineProperty(_ref, TASK, true), _defineProperty(_ref, 'isRunning', function isRunning() {
    return running;
  }), _defineProperty(_ref, 'result', function result() {
    return _result;
  }), _defineProperty(_ref, 'error', function error() {
    return _error;
  }), _defineProperty(_ref, 'setRunning', function setRunning(b) {
    return running = b;
  }), _defineProperty(_ref, 'setResult', function setResult(r) {
    return _result = r;
  }), _defineProperty(_ref, 'setError', function setError(e) {
    return _error = e;
  }), _ref;
}

function autoInc() {
  var seed = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;

  return function () {
    return ++seed;
  };
}

var uid = exports.uid = autoInc();

var kThrow = function kThrow(err) {
  throw err;
};
var kReturn = function kReturn(value) {
  return { value: value, done: true };
};
function makeIterator(next) {
  var thro = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : kThrow;
  var name = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '';
  var isHelper = arguments[3];

  var iterator = { name: name, next: next, throw: thro, return: kReturn };

  if (isHelper) {
    iterator[HELPER] = true;
  }
  if (typeof _symbol2.default !== 'undefined') {
    iterator[_iterator2.default] = function () {
      return iterator;
    };
  }
  return iterator;
}

/**
  Print error in a useful way whether in a browser environment
  (with expandable error stack traces), or in a node.js environment
  (text-only log output)
 **/
function log(level, message, error) {
  /*eslint-disable no-console*/
  if (typeof window === 'undefined') {
    console.log('redux-saga ' + level + ': ' + message + '\n' + (error && error.stack || error));
  } else {
    console[level](message, error);
  }
}

var internalErr = exports.internalErr = function internalErr(err) {
  return new Error('\n  redux-saga: Error checking hooks detected an inconsistent state. This is likely a bug\n  in redux-saga code and not yours. Thanks for reporting this in the project\'s github repo.\n  Error: ' + err + '\n');
};

function wrapSagaDispatch(dispatch) {
  return function sagaDispatch(action) {
    var wrappedAction = (0, _defineProperty3.default)(action, SAGA_ACTION, { value: true });
    return dispatch(wrappedAction);
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInV0aWxzLmpzIl0sIm5hbWVzIjpbIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInZhbHVlIiwiX2V4dGVuZHMiLCJ0YXJnZXQiLCJpIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwic291cmNlIiwia2V5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiX3R5cGVvZiIsIm9iaiIsImNvbnN0cnVjdG9yIiwiY2hlY2siLCJyZW1vdmUiLCJkZWZlcnJlZCIsImFycmF5T2ZEZWZmZXJlZCIsImRlbGF5IiwiY3JlYXRlTW9ja1Rhc2siLCJhdXRvSW5jIiwibWFrZUl0ZXJhdG9yIiwibG9nIiwid3JhcFNhZ2FEaXNwYXRjaCIsIl9kZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsInN5bSIsImlkIiwiVEFTSyIsIkhFTFBFUiIsIk1BVENIIiwiQ0FOQ0VMIiwiU0FHQV9BQ1RJT04iLCJrb25zdCIsInYiLCJrVHJ1ZSIsImtGYWxzZSIsIm5vb3AiLCJpZGVudCIsInByZWRpY2F0ZSIsImVycm9yIiwiRXJyb3IiLCJpcyIsInVuZGVmIiwidW5kZWZpbmVkIiwibm90VW5kZWYiLCJmdW5jIiwiZiIsIm51bWJlciIsIm4iLCJhcnJheSIsIkFycmF5IiwiaXNBcnJheSIsInByb21pc2UiLCJwIiwidGhlbiIsIml0ZXJhdG9yIiwiaXQiLCJuZXh0IiwidGhyb3ciLCJ0YXNrIiwidCIsIm9ic2VydmFibGUiLCJvYiIsInN1YnNjcmliZSIsImJ1ZmZlciIsImJ1ZiIsImlzRW1wdHkiLCJ0YWtlIiwicHV0IiwicGF0dGVybiIsInBhdCIsImNoYW5uZWwiLCJjaCIsImNsb3NlIiwiaGVscGVyIiwiaXRlbSIsImluZGV4IiwiaW5kZXhPZiIsInNwbGljZSIsInByb3BzIiwiZGVmIiwicmVzb2x2ZSIsInJlamVjdCIsImFyciIsInB1c2giLCJtcyIsInZhbCIsInRpbWVvdXRJZCIsInNldFRpbWVvdXQiLCJjbGVhclRpbWVvdXQiLCJfcmVmIiwicnVubmluZyIsIl9yZXN1bHQiLCJfZXJyb3IiLCJpc1J1bm5pbmciLCJyZXN1bHQiLCJzZXRSdW5uaW5nIiwiYiIsInNldFJlc3VsdCIsInIiLCJzZXRFcnJvciIsImUiLCJzZWVkIiwidWlkIiwia1Rocm93IiwiZXJyIiwia1JldHVybiIsImRvbmUiLCJ0aHJvIiwibmFtZSIsImlzSGVscGVyIiwicmV0dXJuIiwibGV2ZWwiLCJtZXNzYWdlIiwid2luZG93IiwiY29uc29sZSIsInN0YWNrIiwiaW50ZXJuYWxFcnIiLCJkaXNwYXRjaCIsInNhZ2FEaXNwYXRjaCIsImFjdGlvbiIsIndyYXBwZWRBY3Rpb24iXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBRUFBLE9BQU9DLGNBQVAsQ0FBc0JDLE9BQXRCLEVBQStCLFlBQS9CLEVBQTZDO0FBQzNDQyxTQUFPO0FBRG9DLENBQTdDOztBQUlBLElBQUlDLFdBQVcsb0JBQWlCLFVBQVVDLE1BQVYsRUFBa0I7QUFBRSxPQUFLLElBQUlDLElBQUksQ0FBYixFQUFnQkEsSUFBSUMsVUFBVUMsTUFBOUIsRUFBc0NGLEdBQXRDLEVBQTJDO0FBQUUsUUFBSUcsU0FBU0YsVUFBVUQsQ0FBVixDQUFiLENBQTJCLEtBQUssSUFBSUksR0FBVCxJQUFnQkQsTUFBaEIsRUFBd0I7QUFBRSxVQUFJVCxPQUFPVyxTQUFQLENBQWlCQyxjQUFqQixDQUFnQ0MsSUFBaEMsQ0FBcUNKLE1BQXJDLEVBQTZDQyxHQUE3QyxDQUFKLEVBQXVEO0FBQUVMLGVBQU9LLEdBQVAsSUFBY0QsT0FBT0MsR0FBUCxDQUFkO0FBQTRCO0FBQUU7QUFBRSxHQUFDLE9BQU9MLE1BQVA7QUFBZ0IsQ0FBaFE7O0FBRUEsSUFBSVMsVUFBVSw0QkFBa0IsVUFBbEIsSUFBZ0MsOENBQTJCLFFBQTNELEdBQXNFLFVBQVVDLEdBQVYsRUFBZTtBQUFFLGdCQUFjQSxHQUFkLHVEQUFjQSxHQUFkO0FBQW9CLENBQTNHLEdBQThH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LEdBQStCQyxPQUEvQixHQUF5QyxJQUF6QyxJQUFpRDFFLFNBQVNBLE1BQU02RSxLQUFmLElBQXdCN0UsS0FBekUsQ0FBWjtBQUNELEdBRkQsTUFFTztBQUNMNEUsWUFBUUgsS0FBUixFQUFlQyxPQUFmLEVBQXdCMUUsS0FBeEI7QUFDRDtBQUNGOztBQUVELElBQUk4RSxjQUFjekgsUUFBUXlILFdBQVIsR0FBc0IsU0FBU0EsV0FBVCxDQUFxQlosR0FBckIsRUFBMEI7QUFDaEUsU0FBTyxJQUFJakUsS0FBSixDQUFVLHVNQUF1TWlFLEdBQXZNLEdBQTZNLElBQXZOLENBQVA7QUFDRCxDQUZEOztBQUlBLFNBQVNyRixnQkFBVCxDQUEwQmtHLFFBQTFCLEVBQW9DO0FBQ2xDLFNBQU8sU0FBU0MsWUFBVCxDQUFzQkMsTUFBdEIsRUFBOEI7QUFDbkMsUUFBSUMsZ0JBQWdCLDhCQUFzQkQsTUFBdEIsRUFBOEJ6RixXQUE5QixFQUEyQyxFQUFFbEMsT0FBTyxJQUFULEVBQTNDLENBQXBCO0FBQ0EsV0FBT3lILFNBQVNHLGFBQVQsQ0FBUDtBQUNELEdBSEQ7QUFJRCIsImZpbGUiOiJ1bmtub3duIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2V4dGVuZHMgPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uICh0YXJnZXQpIHsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXTsgZm9yICh2YXIga2V5IGluIHNvdXJjZSkgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkgeyB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldOyB9IH0gfSByZXR1cm4gdGFyZ2V0OyB9O1xuXG52YXIgX3R5cGVvZiA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7IH07XG5cbmV4cG9ydHMuY2hlY2sgPSBjaGVjaztcbmV4cG9ydHMucmVtb3ZlID0gcmVtb3ZlO1xuZXhwb3J0cy5kZWZlcnJlZCA9IGRlZmVycmVkO1xuZXhwb3J0cy5hcnJheU9mRGVmZmVyZWQgPSBhcnJheU9mRGVmZmVyZWQ7XG5leHBvcnRzLmRlbGF5ID0gZGVsYXk7XG5leHBvcnRzLmNyZWF0ZU1vY2tUYXNrID0gY3JlYXRlTW9ja1Rhc2s7XG5leHBvcnRzLmF1dG9JbmMgPSBhdXRvSW5jO1xuZXhwb3J0cy5tYWtlSXRlcmF0b3IgPSBtYWtlSXRlcmF0b3I7XG5leHBvcnRzLmxvZyA9IGxvZztcbmV4cG9ydHMud3JhcFNhZ2FEaXNwYXRjaCA9IHdyYXBTYWdhRGlzcGF0Y2g7XG5cbmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9XG5cbnZhciBzeW0gPSBleHBvcnRzLnN5bSA9IGZ1bmN0aW9uIHN5bShpZCkge1xuICByZXR1cm4gJ0BAcmVkdXgtc2FnYS8nICsgaWQ7XG59O1xudmFyIFRBU0sgPSBleHBvcnRzLlRBU0sgPSBzeW0oJ1RBU0snKTtcbnZhciBIRUxQRVIgPSBleHBvcnRzLkhFTFBFUiA9IHN5bSgnSEVMUEVSJyk7XG52YXIgTUFUQ0ggPSBleHBvcnRzLk1BVENIID0gc3ltKCdNQVRDSCcpO1xudmFyIENBTkNFTCA9IGV4cG9ydHMuQ0FOQ0VMID0gc3ltKCdjYW5jZWxQcm9taXNlJyk7XG52YXIgU0FHQV9BQ1RJT04gPSBleHBvcnRzLlNBR0FfQUNUSU9OID0gc3ltKCdTQUdBX0FDVElPTicpO1xudmFyIGtvbnN0ID0gZXhwb3J0cy5rb25zdCA9IGZ1bmN0aW9uIGtvbnN0KHYpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdjtcbiAgfTtcbn07XG52YXIga1RydWUgPSBleHBvcnRzLmtUcnVlID0ga29uc3QodHJ1ZSk7XG52YXIga0ZhbHNlID0gZXhwb3J0cy5rRmFsc2UgPSBrb25zdChmYWxzZSk7XG52YXIgbm9vcCA9IGV4cG9ydHMubm9vcCA9IGZ1bmN0aW9uIG5vb3AoKSB7fTtcbnZhciBpZGVudCA9IGV4cG9ydHMuaWRlbnQgPSBmdW5jdGlvbiBpZGVudCh2KSB7XG4gIHJldHVybiB2O1xufTtcblxuZnVuY3Rpb24gY2hlY2sodmFsdWUsIHByZWRpY2F0ZSwgZXJyb3IpIHtcbiAgaWYgKCFwcmVkaWNhdGUodmFsdWUpKSB7XG4gICAgbG9nKCdlcnJvcicsICd1bmNhdWdodCBhdCBjaGVjaycsIGVycm9yKTtcbiAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3IpO1xuICB9XG59XG5cbnZhciBpcyA9IGV4cG9ydHMuaXMgPSB7XG4gIHVuZGVmOiBmdW5jdGlvbiB1bmRlZih2KSB7XG4gICAgcmV0dXJuIHYgPT09IG51bGwgfHwgdiA9PT0gdW5kZWZpbmVkO1xuICB9LFxuICBub3RVbmRlZjogZnVuY3Rpb24gbm90VW5kZWYodikge1xuICAgIHJldHVybiB2ICE9PSBudWxsICYmIHYgIT09IHVuZGVmaW5lZDtcbiAgfSxcbiAgZnVuYzogZnVuY3Rpb24gZnVuYyhmKSB7XG4gICAgcmV0dXJuIHR5cGVvZiBmID09PSAnZnVuY3Rpb24nO1xuICB9LFxuICBudW1iZXI6IGZ1bmN0aW9uIG51bWJlcihuKSB7XG4gICAgcmV0dXJuIHR5cGVvZiBuID09PSAnbnVtYmVyJztcbiAgfSxcbiAgYXJyYXk6IEFycmF5LmlzQXJyYXksXG4gIHByb21pc2U6IGZ1bmN0aW9uIHByb21pc2UocCkge1xuICAgIHJldHVybiBwICYmIGlzLmZ1bmMocC50aGVuKTtcbiAgfSxcbiAgaXRlcmF0b3I6IGZ1bmN0aW9uIGl0ZXJhdG9yKGl0KSB7XG4gICAgcmV0dXJuIGl0ICYmIGlzLmZ1bmMoaXQubmV4dCkgJiYgaXMuZnVuYyhpdC50aHJvdyk7XG4gIH0sXG4gIHRhc2s6IGZ1bmN0aW9uIHRhc2sodCkge1xuICAgIHJldHVybiB0ICYmIHRbVEFTS107XG4gIH0sXG4gIG9ic2VydmFibGU6IGZ1bmN0aW9uIG9ic2VydmFibGUob2IpIHtcbiAgICByZXR1cm4gb2IgJiYgaXMuZnVuYyhvYi5zdWJzY3JpYmUpO1xuICB9LFxuICBidWZmZXI6IGZ1bmN0aW9uIGJ1ZmZlcihidWYpIHtcbiAgICByZXR1cm4gYnVmICYmIGlzLmZ1bmMoYnVmLmlzRW1wdHkpICYmIGlzLmZ1bmMoYnVmLnRha2UpICYmIGlzLmZ1bmMoYnVmLnB1dCk7XG4gIH0sXG4gIHBhdHRlcm46IGZ1bmN0aW9uIHBhdHRlcm4ocGF0KSB7XG4gICAgcmV0dXJuIHBhdCAmJiAodHlwZW9mIHBhdCA9PT0gJ3N0cmluZycgfHwgKHR5cGVvZiBwYXQgPT09ICd1bmRlZmluZWQnID8gJ3VuZGVmaW5lZCcgOiBfdHlwZW9mKHBhdCkpID09PSAnc3ltYm9sJyB8fCBpcy5mdW5jKHBhdCkgfHwgaXMuYXJyYXkocGF0KSk7XG4gIH0sXG4gIGNoYW5uZWw6IGZ1bmN0aW9uIGNoYW5uZWwoY2gpIHtcbiAgICByZXR1cm4gY2ggJiYgaXMuZnVuYyhjaC50YWtlKSAmJiBpcy5mdW5jKGNoLmNsb3NlKTtcbiAgfSxcbiAgaGVscGVyOiBmdW5jdGlvbiBoZWxwZXIoaXQpIHtcbiAgICByZXR1cm4gaXQgJiYgaXRbSEVMUEVSXTtcbiAgfVxufTtcblxuZnVuY3Rpb24gcmVtb3ZlKGFycmF5LCBpdGVtKSB7XG4gIHZhciBpbmRleCA9IGFycmF5LmluZGV4T2YoaXRlbSk7XG4gIGlmIChpbmRleCA+PSAwKSB7XG4gICAgYXJyYXkuc3BsaWNlKGluZGV4LCAxKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBkZWZlcnJlZCgpIHtcbiAgdmFyIHByb3BzID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcblxuICB2YXIgZGVmID0gX2V4dGVuZHMoe30sIHByb3BzKTtcbiAgdmFyIHByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgZGVmLnJlc29sdmUgPSByZXNvbHZlO1xuICAgIGRlZi5yZWplY3QgPSByZWplY3Q7XG4gIH0pO1xuICBkZWYucHJvbWlzZSA9IHByb21pc2U7XG4gIHJldHVybiBkZWY7XG59XG5cbmZ1bmN0aW9uIGFycmF5T2ZEZWZmZXJlZChsZW5ndGgpIHtcbiAgdmFyIGFyciA9IFtdO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgYXJyLnB1c2goZGVmZXJyZWQoKSk7XG4gIH1cbiAgcmV0dXJuIGFycjtcbn1cblxuZnVuY3Rpb24gZGVsYXkobXMpIHtcbiAgdmFyIHZhbCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogdHJ1ZTtcblxuICB2YXIgdGltZW91dElkID0gdm9pZCAwO1xuICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgdGltZW91dElkID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gcmVzb2x2ZSh2YWwpO1xuICAgIH0sIG1zKTtcbiAgfSk7XG5cbiAgcHJvbWlzZVtDQU5DRUxdID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBjbGVhclRpbWVvdXQodGltZW91dElkKTtcbiAgfTtcblxuICByZXR1cm4gcHJvbWlzZTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlTW9ja1Rhc2soKSB7XG4gIHZhciBfcmVmO1xuXG4gIHZhciBydW5uaW5nID0gdHJ1ZTtcbiAgdmFyIF9yZXN1bHQgPSB2b2lkIDAsXG4gICAgICBfZXJyb3IgPSB2b2lkIDA7XG5cbiAgcmV0dXJuIF9yZWYgPSB7fSwgX2RlZmluZVByb3BlcnR5KF9yZWYsIFRBU0ssIHRydWUpLCBfZGVmaW5lUHJvcGVydHkoX3JlZiwgJ2lzUnVubmluZycsIGZ1bmN0aW9uIGlzUnVubmluZygpIHtcbiAgICByZXR1cm4gcnVubmluZztcbiAgfSksIF9kZWZpbmVQcm9wZXJ0eShfcmVmLCAncmVzdWx0JywgZnVuY3Rpb24gcmVzdWx0KCkge1xuICAgIHJldHVybiBfcmVzdWx0O1xuICB9KSwgX2RlZmluZVByb3BlcnR5KF9yZWYsICdlcnJvcicsIGZ1bmN0aW9uIGVycm9yKCkge1xuICAgIHJldHVybiBfZXJyb3I7XG4gIH0pLCBfZGVmaW5lUHJvcGVydHkoX3JlZiwgJ3NldFJ1bm5pbmcnLCBmdW5jdGlvbiBzZXRSdW5uaW5nKGIpIHtcbiAgICByZXR1cm4gcnVubmluZyA9IGI7XG4gIH0pLCBfZGVmaW5lUHJvcGVydHkoX3JlZiwgJ3NldFJlc3VsdCcsIGZ1bmN0aW9uIHNldFJlc3VsdChyKSB7XG4gICAgcmV0dXJuIF9yZXN1bHQgPSByO1xuICB9KSwgX2RlZmluZVByb3BlcnR5KF9yZWYsICdzZXRFcnJvcicsIGZ1bmN0aW9uIHNldEVycm9yKGUpIHtcbiAgICByZXR1cm4gX2Vycm9yID0gZTtcbiAgfSksIF9yZWY7XG59XG5cbmZ1bmN0aW9uIGF1dG9JbmMoKSB7XG4gIHZhciBzZWVkID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAwO1xuXG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuICsrc2VlZDtcbiAgfTtcbn1cblxudmFyIHVpZCA9IGV4cG9ydHMudWlkID0gYXV0b0luYygpO1xuXG52YXIga1Rocm93ID0gZnVuY3Rpb24ga1Rocm93KGVycikge1xuICB0aHJvdyBlcnI7XG59O1xudmFyIGtSZXR1cm4gPSBmdW5jdGlvbiBrUmV0dXJuKHZhbHVlKSB7XG4gIHJldHVybiB7IHZhbHVlOiB2YWx1ZSwgZG9uZTogdHJ1ZSB9O1xufTtcbmZ1bmN0aW9uIG1ha2VJdGVyYXRvcihuZXh0KSB7XG4gIHZhciB0aHJvID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBrVGhyb3c7XG4gIHZhciBuYW1lID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiAnJztcbiAgdmFyIGlzSGVscGVyID0gYXJndW1lbnRzWzNdO1xuXG4gIHZhciBpdGVyYXRvciA9IHsgbmFtZTogbmFtZSwgbmV4dDogbmV4dCwgdGhyb3c6IHRocm8sIHJldHVybjoga1JldHVybiB9O1xuXG4gIGlmIChpc0hlbHBlcikge1xuICAgIGl0ZXJhdG9yW0hFTFBFUl0gPSB0cnVlO1xuICB9XG4gIGlmICh0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJykge1xuICAgIGl0ZXJhdG9yW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gaXRlcmF0b3I7XG4gICAgfTtcbiAgfVxuICByZXR1cm4gaXRlcmF0b3I7XG59XG5cbi8qKlxyXG4gIFByaW50IGVycm9yIGluIGEgdXNlZnVsIHdheSB3aGV0aGVyIGluIGEgYnJvd3NlciBlbnZpcm9ubWVudFxyXG4gICh3aXRoIGV4cGFuZGFibGUgZXJyb3Igc3RhY2sgdHJhY2VzKSwgb3IgaW4gYSBub2RlLmpzIGVudmlyb25tZW50XHJcbiAgKHRleHQtb25seSBsb2cgb3V0cHV0KVxyXG4gKiovXG5mdW5jdGlvbiBsb2cobGV2ZWwsIG1lc3NhZ2UsIGVycm9yKSB7XG4gIC8qZXNsaW50LWRpc2FibGUgbm8tY29uc29sZSovXG4gIGlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJykge1xuICAgIGNvbnNvbGUubG9nKCdyZWR1eC1zYWdhICcgKyBsZXZlbCArICc6ICcgKyBtZXNzYWdlICsgJ1xcbicgKyAoZXJyb3IgJiYgZXJyb3Iuc3RhY2sgfHwgZXJyb3IpKTtcbiAgfSBlbHNlIHtcbiAgICBjb25zb2xlW2xldmVsXShtZXNzYWdlLCBlcnJvcik7XG4gIH1cbn1cblxudmFyIGludGVybmFsRXJyID0gZXhwb3J0cy5pbnRlcm5hbEVyciA9IGZ1bmN0aW9uIGludGVybmFsRXJyKGVycikge1xuICByZXR1cm4gbmV3IEVycm9yKCdcXG4gIHJlZHV4LXNhZ2E6IEVycm9yIGNoZWNraW5nIGhvb2tzIGRldGVjdGVkIGFuIGluY29uc2lzdGVudCBzdGF0ZS4gVGhpcyBpcyBsaWtlbHkgYSBidWdcXG4gIGluIHJlZHV4LXNhZ2EgY29kZSBhbmQgbm90IHlvdXJzLiBUaGFua3MgZm9yIHJlcG9ydGluZyB0aGlzIGluIHRoZSBwcm9qZWN0XFwncyBnaXRodWIgcmVwby5cXG4gIEVycm9yOiAnICsgZXJyICsgJ1xcbicpO1xufTtcblxuZnVuY3Rpb24gd3JhcFNhZ2FEaXNwYXRjaChkaXNwYXRjaCkge1xuICByZXR1cm4gZnVuY3Rpb24gc2FnYURpc3BhdGNoKGFjdGlvbikge1xuICAgIHZhciB3cmFwcGVkQWN0aW9uID0gT2JqZWN0LmRlZmluZVByb3BlcnR5KGFjdGlvbiwgU0FHQV9BQ1RJT04sIHsgdmFsdWU6IHRydWUgfSk7XG4gICAgcmV0dXJuIGRpc3BhdGNoKHdyYXBwZWRBY3Rpb24pO1xuICB9O1xufSJdfQ==